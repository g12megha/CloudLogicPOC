'use strict';

var fs = require('fs');
var verror = require('verror');
var tracer = require('../utils/logger').getTracer();
var fsUtils = require('../utils/fs-utils');

exports.readLocalJsonConfig = function(configFilePath, configName) {
  if (!exports.findLocalConfigFile(configFilePath, configName)) {
    return;
  }

  try {
    return JSON.parse(fs.readFileSync(configFilePath, 'utf8'));
  } catch (e) {
    throw new verror.VError(e, 'File %s content is not valid JSON', configFilePath);
  }
};

exports.findLocalConfigFile = function(configFilePath, configName) {
  if (fsUtils.isFile(configFilePath)) {
    tracer.info('Using local %s configuration "%s" ', configName, configFilePath);
    return configFilePath;
  } else {
    tracer.info('Local %s configuration file "%s" does not exist', configName, configFilePath);
  }
};
