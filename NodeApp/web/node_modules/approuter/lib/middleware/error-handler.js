'use strict';

var http = require('http');
var xhr = require('../xhr-login/xhr');

module.exports = function errorHandler(err, req, res, next) { // eslint-disable-line no-unused-vars
  var status = err.status || 500;
  var logger = req.loggingContext.getLogger('/Handler');

  logger.error('Error, status: %d %s: %s', status, err.message, req.url);
  logger.error(err);

  if (xhr.isXhrLogin(req)) {
    logger.info('Sending xhr login reponse html');
    return xhr.sendLoginErrorHtml(res, err);
  }
  res.writeHead(status);
  res.end(http.STATUS_CODES[status]);
};
