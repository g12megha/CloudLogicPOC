'use strict';

var SAPPassport = require('sap-e2e-trace').Passport;

module.exports = {
  getBasicAuthHeader: function (username, password) {
    return {'authorization': 'Basic ' + new Buffer(username + ':' + password).toString('base64')};
  },
  updateSapPassport: function (headers, optTargetHeaders) {
    var passportHeader = headers[SAPPassport.HEADER_NAME];
    if (passportHeader) {
      var passport = new SAPPassport(passportHeader);
      passport.update({
        previousComponent: 'sap-application-router',
        connectionID: '00000000000000000000000000000000',
        connectionCounter: 0
      });
      var headersToUpdate = optTargetHeaders || headers;
      headersToUpdate[SAPPassport.HEADER_NAME] = passport.serialize();
    }
  }
};
